<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TwistedPic - Distorted Image Generator</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üé® TwistedPic</h1>
            <p class="subtitle">Distorted Image Generator</p>
            <div class="service-status">
                <span id="status-ollama" class="status-indicator" title="Ollama Server">
                    <span class="status-dot offline"></span> Ollama
                </span>
                <span id="status-twistedpair" class="status-indicator" title="TwistedPair V2">
                    <span class="status-dot offline"></span> TwistedPair
                </span>
                <span id="status-imagemodel" class="status-indicator" title="Image Model">
                    <span class="status-dot offline"></span> SDXL
                </span>
            </div>
        </header>

        <div class="main-layout">
            <!-- Left Panel: Settings -->
            <div class="settings-panel">
                <h2>Settings</h2>
                
                <!-- User Prompt -->
                <div class="form-group">
                    <label for="user-prompt">Your Prompt</label>
                    <textarea 
                        id="user-prompt" 
                        placeholder="Describe what you want to visualize..."
                        rows="3"
                    ></textarea>
                </div>

                <!-- TwistedPair Distortion -->
                <h3>üîä Distortion Controls</h3>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="enable-distortion" checked>
                        Enable Distortion
                    </label>
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="enable-refinement" checked>
                        Refine to Visual Keywords
                    </label>
                    <small class="help-text">Extract 15-25 visual keywords from verbose distortion</small>
                </div>

                <div id="distortion-controls">
                <div class="form-group">
                    <label for="distortion-model">LLM Model</label>
                    <select id="distortion-model">
                        <option value="">Loading models...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="distortion-mode">Mode</label>
                    <select id="distortion-mode">
                        <option value="echo_er">Echo-er (Amplify)</option>
                        <option value="invert_er">Invert-er (Challenge)</option>
                        <option value="so_what_er">So-What-er (Implications)</option>
                        <option value="what_if_er">What-If-er (Alternatives)</option>
                        <option value="cucumb_er">Cucumb-er (Evidence)</option>
                        <option value="archiv_er">Archiv-er (History)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="distortion-tone">Tone</label>
                    <select id="distortion-tone">
                        <option value="neutral">Neutral</option>
                        <option value="technical">Technical</option>
                        <option value="primal">Primal</option>
                        <option value="poetic">Poetic</option>
                        <option value="satirical">Satirical</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="distortion-gain">
                        Gain: <span id="gain-value">5</span>
                    </label>
                    <input 
                        type="range" 
                        id="distortion-gain" 
                        min="1" 
                        max="10" 
                        value="5"
                        class="slider"
                    >
                    <div class="slider-labels">
                        <span>1 (Subtle)</span>
                        <span>10 (Intense)</span>
                    </div>
                </div>
                </div>

                <!-- Image Generation -->
                <h3>üñºÔ∏è Image Settings</h3>

                <div class="form-group">
                    <label for="resolution">Resolution</label>
                    <select id="resolution">
                        <option value="landscape">768√ó512 (Landscape)</option>
                        <option value="portrait">512√ó768 (Portrait)</option>
                        <option value="square">1024√ó1024 (Square)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="quality">
                        Quality: <span id="quality-value">30</span> steps
                    </label>
                    <input 
                        type="range" 
                        id="quality" 
                        min="10" 
                        max="50" 
                        value="30"
                        class="slider"
                    >
                    <div class="slider-labels">
                        <span>Fast</span>
                        <span>Detailed</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="style">
                        Style: <span id="style-value">7.5</span> CFG
                    </label>
                    <input 
                        type="range" 
                        id="style" 
                        min="5" 
                        max="15" 
                        step="0.5"
                        value="7.5"
                        class="slider"
                    >
                    <div class="slider-labels">
                        <span>Creative</span>
                        <span>Literal</span>
                    </div>
                </div>

                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="random-seed">
                        Random Seed (non-reproducible)
                    </label>
                </div>

                <!-- Action Buttons -->
                <div class="button-group">
                    <button id="btn-generate" class="btn btn-primary" disabled>
                        Generate Image
                    </button>
                    <button id="btn-new" class="btn btn-secondary">
                        New Image
                    </button>
                </div>
            </div>

            <!-- Right Panel: Output -->
            <div class="output-panel">
                <h2>Generated Image</h2>
                
                <!-- Progress Bar -->
                <div id="progress-container" class="progress-container" style="display: none;">
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill"></div>
                    </div>
                    <p id="progress-text" class="progress-text">Initializing...</p>
                </div>

                <!-- Image Display -->
                <div id="image-container" class="image-container">
                    <div class="placeholder">
                        <p>üëÜ Configure settings and press "Generate Image"</p>
                    </div>
                </div>

                <!-- Distorted Prompt Display -->
                <div id="distorted-prompt-container" class="distorted-prompt-container" style="display: none;">
                    <h3>Verbose Distortion</h3>
                    <div id="distorted-prompt-text" class="distorted-prompt-text"></div>
                </div>

                <!-- Refined Keywords Display -->
                <div id="refined-keywords-container" class="refined-keywords-container" style="display: none;">
                    <h3>Refined Visual Keywords</h3>
                    <div id="refined-keywords-text" class="refined-keywords-text"></div>
                </div>

                <!-- Image Prompt Display -->
                <div id="image-prompt-container" class="image-prompt-container" style="display: none;">
                    <h3>Final SDXL Prompt</h3>
                    <div id="image-prompt-text" class="image-prompt-text"></div>
                </div>

                <!-- Save Button -->
                <button id="btn-save" class="btn btn-success" style="display: none;">
                    üíæ Save Image
                </button>

                <!-- Error Display -->
                <div id="error-container" class="error-container" style="display: none;">
                    <p id="error-text"></p>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
